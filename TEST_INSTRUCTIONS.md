# 🧪 دستورالعمل تست ربات P24_SlotHunter

## ✅ تغییرات انجام شده

### 1. **حل مشکل ConversationHandler**
- مشکل اصلی که callback های `admin_add_doctor` به ConversationHandler نمی‌رسیدند حل شد
- حالا سیستم اضافه کردن دکتر باید به درستی کار کند

### 2. **حذف دکتر پیش‌فرض**
- دکتر نمونه از فایل `config/config.yaml` حذف شد
- حالا سیستم با لیست خالی شروع می‌کند

### 3. **تمیزسازی کد**
- فایل `callback_handlers.py` تمیز شد
- قسمت‌های پیاده‌نشده حذف شدند
- فقط قابلیت‌های کاربردی نگه داشته شدند

### 4. **بهبود سیستم ادمین**
- سیستم نقش‌های کاربری بهبود یافت
- منوهای ادمین تمیز شدند

---

## 🔧 تست‌های مورد ن��از

### **تست 1: راه‌اندازی ربات**
```bash
# در سرور لینوکس:
cd /path/to/P24_SlotHunter
python src/main.py
```

**انتظار:** ربات باید بدون خطا راه‌اندازی شود

---

### **تست 2: دسترسی ادمین**
1. در تلگرام دستور `/start` را بزنید
2. از منوی کیبورد گزینه **"👑 پنل ادمین"** را انتخاب کنید

**انتظار:** منوی ادمین نمایش داده شود

---

### **تست 3: اضافه کردن دکتر جدید** ⭐ **مهم**
1. در پنل ادمین روی **"➕ افزودن دکتر"** کلیک کنید
2. لینک یک دکتر از پذیرش۲۴ را ارسال کنید

**نمونه لینک برای تست:**
```
https://www.paziresh24.com/dr/دکتر-علی-احمدی-0/
```

**انتظار:** 
- ربات باید لینک را پردازش کند
- اطلاعات دکتر را نمایش دهد
- گزینه تأیید/لغو ارائه دهد

---

### **تست 4: مشاهده دکترها**
1. از منوی اصلی **"👨‍⚕️ دکترها"** را انتخاب کنید

**انتظار:** 
- اگر دکتری اضافه نشده: پیام "هیچ دکتری ثبت نشده"
- اگر دکتری اضافه شده: لیست دکترها نمایش داده شود

---

### **تست 5: اشتراک در دکتر**
1. **"🔔 اشتراک جدید"** را انتخاب کنید
2. روی نام دکتر کلیک کنید

**انتظار:** پیام موفقیت اشتراک

---

### **تست 6: مشاهده اشتراک‌ها**
1. **"📝 اشتراک‌ها"** را انتخاب کنید

**انتظار:** لیست اشتراک‌های فعال

---

## 🚨 مشکلات احتمالی و راه‌حل

### **مشکل 1: ربات پاسخ نمی‌دهد**
```bash
# بررسی لاگ‌ها:
tail -f logs/slothunter.log
```

### **مشکل 2: خطای دیتابیس**
```bash
# حذف دیتابیس و شروع مجدد:
rm -f data/slothunter.db
python src/main.py
```

### **مشکل 3: خطای دسترسی ادمین**
- مطمئن شوید `ADMIN_CHAT_ID` در `.env` درست تنظیم شده
- شناسه تلگرام خود را بررسی کنید

---

## 📋 چک‌لیست تست

- [ ] ربات راه‌اندازی می‌شود
- [ ] منوی اصلی نمایش داده می‌شود  
- [ ] دسترسی ادمین کار می‌کند
- [ ] **اضافه کردن دکتر کار می‌کند** ⭐
- [ ] لیست دکترها نمایش داده می‌شود
- [ ] اشتراک در دکتر کار می‌کند
- [ ] لغو اشتراک کار می‌کند
- [ ] دکمه‌های بازگشت کار می‌کنند

---

## 🔍 نکات مهم بر��ی تست

1. **حتماً با یک لینک واقعی از پذیرش۲۴ تست کنید**
2. **اگر خطایی دیدید، لاگ کامل را بفرستید**
3. **مراحل تست را دقیقاً دنبال کنید**
4. **هر مرحله را جداگانه تست کنید**

---

## 📞 در صورت مشکل

اگر هر مرحله‌ای کار نکرد:
1. **اسکرین‌شات** از خطا بگیرید
2. **لاگ‌های ربات** را چک کنید
3. **مرحله دقیق** که مشکل دارد را مشخص کنید
4. **پیام خطای دقیق** را گزارش دهید

---

## ✨ انتظارات

پس از این تغییرات:
- ✅ سیستم اضافه کردن دکتر باید کاملاً کار کند
- ✅ تمام دکمه‌ها باید پاسخ دهند  
- ✅ بازگشت‌ها باید درست کار کنند
- ✅ دکتر پیش‌فرض حذف شده است
- ✅ فقط قابلیت‌های کاربردی باقی مانده‌اند